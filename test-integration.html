<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morning Challenge - çµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <!-- æ³¨æ„: æœ¬ç•ªç’°å¢ƒã§ã¯Tailwind CSS CDNã§ã¯ãªãã€PostCSSãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¾ãŸã¯Tailwind CLIã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .status-ok { color: #10b981; }
        .status-error { color: #ef4444; }
        .status-testing { color: #f59e0b; }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-8">ğŸŒ… Morning Challenge çµ±åˆãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ”§ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API</h2>
                <div id="backend-status" class="status-testing">ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­...</div>
                <div class="mt-4">
                    <button onclick="testBackend()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                        APIå†ãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
                <div id="backend-details" class="mt-4 text-sm text-gray-600"></div>
            </div>

            <!-- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ¨ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</h2>
                <div id="frontend-status" class="status-ok">âœ… æ­£å¸¸å‹•ä½œä¸­</div>
                <div class="mt-4">
                    <button onclick="testFrontend()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                        æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
                <div id="frontend-details" class="mt-4 text-sm text-gray-600">
                    ã“ã®ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€åŸºæœ¬çš„ãªãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½ã¯å‹•ä½œä¸­
                </div>
            </div>
        </div>

        <!-- çµ±åˆãƒ†ã‚¹ãƒˆçµæœ -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆçµæœ</h2>
            <div id="integration-status" class="status-testing">ğŸ”„ ãƒ†ã‚¹ãƒˆæº–å‚™ä¸­...</div>
            <div class="mt-4">
                <button onclick="runIntegrationTest()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                </button>
            </div>
            <div id="integration-details" class="mt-4 text-sm text-gray-600"></div>
        </div>

        <!-- ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ± -->
        <div class="bg-blue-50 rounded-lg p-6 mt-6">
            <h3 class="text-lg font-semibold mb-2">ğŸ“ ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±</h3>
            <ul class="space-y-2 text-sm">
                <li><strong>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:</strong> <a href="http://localhost:3004" target="_blank" class="text-blue-600 hover:underline">http://localhost:3004</a></li>
                <li><strong>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API:</strong> <a href="http://localhost:5003" target="_blank" class="text-blue-600 hover:underline">http://localhost:5003</a></li>
                <li><strong>çµ±åˆãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸:</strong> ã“ã®ãƒšãƒ¼ã‚¸</li>
            </ul>
        </div>
    </div>

    <script>
        // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãƒ†ã‚¹ãƒˆ
        async function testBackend() {
            const statusElement = document.getElementById('backend-status');
            const detailsElement = document.getElementById('backend-details');
            
            statusElement.className = 'status-testing';
            statusElement.textContent = 'ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­...';
            
            try {
                // è¤‡æ•°ã®ãƒãƒ¼ãƒˆã‚’è©¦è¡Œ
                const ports = [5003, 3001, 5000];
                let success = false;
                let lastError = '';
                
                for (const port of ports) {
                    try {
                        const response = await fetch(`http://localhost:${port}/api/health`, {
                            method: 'GET',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            timeout: 5000
                        });
                        
                        if (response.ok) {
                            statusElement.className = 'status-ok';
                            statusElement.textContent = `âœ… APIå¿œç­”OK (ãƒãƒ¼ãƒˆ:${port})`;
                            detailsElement.textContent = `ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${response.status}, ãƒãƒ¼ãƒˆ: ${port}`;
                            success = true;
                            break;
                        }
                    } catch (error) {
                        lastError = error.message;
                        continue;
                    }
                }
                
                if (!success) {
                    throw new Error(lastError || 'ã™ã¹ã¦ã®ãƒãƒ¼ãƒˆã§æ¥ç¶šå¤±æ•—');
                }
                
            } catch (error) {
                statusElement.className = 'status-error';
                statusElement.textContent = 'âŒ APIæ¥ç¶šå¤±æ•—';
                detailsElement.textContent = `ã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }

        // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
        function testFrontend() {
            const statusElement = document.getElementById('frontend-status');
            const detailsElement = document.getElementById('frontend-details');
            
            // file://ã‹ã‚‰localhost:3004ã¸ã®ç›´æ¥fetchã¯CORSã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ãŸã‚ã€
            // åŸºæœ¬çš„ãªJavaScriptæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ‰‹å‹•ç¢ºèªã‚’ä¿ƒã™
            const hasHTML = document.querySelector('html') !== null;
            const hasCSS = window.getComputedStyle !== undefined;
            const hasJS = typeof fetch !== 'undefined';
            
            if (hasHTML && hasCSS && hasJS) {
                statusElement.className = 'status-ok';
                statusElement.textContent = 'âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åŸºæœ¬æ©Ÿèƒ½OK';
                detailsElement.innerHTML = `
                    JavaScriptæ©Ÿèƒ½æ­£å¸¸ - <a href="http://localhost:3004" target="_blank" class="text-blue-600 hover:underline">http://localhost:3004</a>ã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã„ã¦ç¢ºèªã—ã¦ãã ã•ã„
                `;
            } else {
                statusElement.className = 'status-error';
                statusElement.textContent = 'âŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å•é¡Œ';
                detailsElement.textContent = 'JavaScriptåŸºæœ¬æ©Ÿèƒ½ã«å•é¡ŒãŒã‚ã‚Šã¾ã™';
            }
        }

        // çµ±åˆãƒ†ã‚¹ãƒˆ
        async function runIntegrationTest() {
            const statusElement = document.getElementById('integration-status');
            const detailsElement = document.getElementById('integration-details');
            
            statusElement.className = 'status-testing';
            statusElement.textContent = 'ğŸ”„ çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...';
            
            // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã‚’å…ˆã«å®Ÿè¡Œ
            await testBackend();
            
            // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
            testFrontend();
            
            // çµ±åˆçµæœã®åˆ¤å®š
            const backendOK = document.getElementById('backend-status').textContent.includes('âœ…');
            const frontendOK = document.getElementById('frontend-status').textContent.includes('âœ…');
            
            if (backendOK && frontendOK) {
                statusElement.className = 'status-ok';
                statusElement.textContent = 'ğŸ‰ çµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸï¼ã‚¢ãƒ—ãƒªä½¿ç”¨å¯èƒ½';
                detailsElement.textContent = 'ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é€£æºãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™';
            } else {
                statusElement.className = 'status-error';
                statusElement.textContent = 'âš ï¸ çµ±åˆãƒ†ã‚¹ãƒˆèª²é¡Œã‚ã‚Š';
                detailsElement.textContent = `ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: ${backendOK ? 'OK' : 'NG'}, ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ${frontendOK ? 'OK' : 'NG'}`;
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.addEventListener('load', () => {
            setTimeout(() => {
                runIntegrationTest();
            }, 1000);
        });
    </script>
</body>
</html> 